{
    "collab_server" : "",
    "contents" : "#' Supprime\n#'\n#' @return\n#' @export\n#' @param oo the pattern you want to recognize in the name of the files you want to work on.\n#' @examples\nsupprime<-function(oo = \"dat\")\n{\n  liste<-objects(pattern= oo,pos=1)\n  n<-50\n  par(mfrow=c(1,1),pty=\"m\")\n  for (i in 1:length(liste)) #sequence #:length(liste))\n  {\n    nouvelim<-NULL #vecteur pour les nlles limites\n    nom<-liste[i]\n    print(i);print(nom)\n    donnees<-get(nom,pos=1)\n    profil<-donnees$profil\n    x<-seq(along=profil)\n    limites<-c(1,donnees$limites)\n    mil<-donnees$millesimes\n    l<-length(mil)\n    p<-ceiling(l/n) #nb of windows\n    print(paste(\"nb of windows :\",p))\n    pt<-NULL\n    for (j in 1:p)\n    {\n      m1<-(j-1)*n+1\n      m2<-j*n\n      miln<-mil[m1:m2]\n      miln<-miln[!is.na(miln)]\n      limn<-limites[m1:(m2+1)]\n      limn<-limn[!is.na(limn)]\n      nc<-length(miln) #nb ring\n      p1<-min(limn)\n      p2<-max(limn)\n      pp<-profil[p1:p2]\n      pt<-c(pt,pp)\n      lp<-length(pp)\n      px<-x[p1:p2]\n      plot(px,pp,type=\"l\")\n      abline(v=limn)\n      points(limn,pt[limn],col=\"green\",pch=3,cex=2)\n      title(main=paste(nom,\"windows\",j,\"\",p))\n      pos<-diff(limn)\n      text(limn[-length(limn)]+pos/2,0.9*max(pp),as.character(miln),srt=90,col=\"blue\")\n      print(\"Entrer le nombre de limites a supprimer\")\n      nls<-readline() #nombre limites a supprimer\n      if (nls!=\"0\")\n      { pid<-identify(limn,pt[limn],n=nls) #designation d'une limite a supprimer\n        lpid<-length(pid) #nb de limites supprimmees\n        limn2<-limn[-pid]\n        }\n      else\n      { print(\"And he signs from the tip of his sword a zero...\")\n        limn2<-limn}\n      plot(px,pp,type=\"l\")\n      title(main=paste(nom))\n      abline(v = limn2,col=2,lwd=2)     #abline(0,1)\n      points(limn2, pp[limn2], pch = 3, cex = 2,col=3,lwd=2)\n      pos<-diff(limn2)/2\n      #text(limn2[-length(limn2)]+pos,0.9*max(pp),as.character(miln[-length(miln)]),srt=90,col=\"red\",cex=1)\n      nouvelim<-unique(c(nouvelim, limn2))\n      # readline()\n    }\n    plot(profil, type=\"l\")\n    abline(v=nouvelim)\n    mila<-max(na.omit(mil))\n    nouveaumil<-sort(seq(from=mila,to=mila-length(nouvelim)+2))\n    print(nouveaumil)\n    pos<-diff(nouvelim)\n    text(nouvelim[-length(nouvelim)]+pos/2,0.95*max(pp),as.character(nouveaumil),cex=0.7,srt=90,col=\"red\")\n    # readline()\n    sortie <- list(length = 3)\n    sortie[[1]] <- profil\n    sortie[[2]] <- nouvelim[-1]\n    sortie[[3]] <- nouveaumil\n    names(sortie) <- c(\"profil\",\"limites\",\"millesimes\")\n    assign(paste(nom,sep=\"p\"), sortie, pos = 1, immediate = T)\n\n  }\n}\n",
    "created" : 1492155561276.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "200129950",
    "id" : "83C88F8E",
    "lastKnownWriteTime" : 1516624682,
    "last_content_update" : 1516624682683,
    "path" : "D:/thchauvin/Doc-INRA/Stats R/Packages/MicrodensiteR/R/supprime.R",
    "project_path" : "R/supprime.R",
    "properties" : {
        "tempName" : "Untitled2"
    },
    "relative_order" : 9,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}