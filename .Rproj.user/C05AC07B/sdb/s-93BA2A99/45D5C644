{
    "collab_server" : "",
    "contents" : "#' Ajustepositionlimit\n#'\n#' @return\n#' @export\n#' @param uu the pattern you want to recognize in the name of the files you want to work on.\n#' @param intliss1 Intensity of the first smoothing function.\n#' @param intliss1 Intensity of the seconde smoothing function.\n#' @examples\najustepositionlimite<-function(uu = \"dat\",intliss1,intliss2)\n{\n#source(\"ajustepositionlimite.R\");ajustepositionlimite.R()\npar(mfrow=c(1,1),pty=\"m\")\nliste<-objects(pattern= uu ,pos=1)\nfor (i in 1:length(liste))\n\t{\n\tnom<-liste[i]\n\tprint(nom)\n\tdata<-get(liste[i],pos=1)\n\tprofil<-data$profil\n\tprofilm<-supsmu(seq(along=profil),profil,span=intliss1)[[2]] #lissage léger\n\tplot(profilm)\n\tprofils<-supsmu(seq(along=profil),profil,span=intliss2)[[2]] #lissage un peu plus fort\n\tlines(profils,col=2)\n\tl<-length(profil)*0.0254\n\tlimites<-data$limites[-length(data$limites)]\n\tvnlim<-NULL\n\tyear<-data$millesimes\n  #readline()\n\tfor(j in limites)\n\t\t{\n\t\tlim<-c(j-8,j-7,j-6,j-5,j-4,j-3,j-2,j-1,j,j+1,j+2,j+3,j+4,j+5,j+6,j+7,j+8)\n\t\tlim<-c(j-6,j-5,j-4,j-3,j-2,j-1,j,j+1,j+2,j+3,j+4,j+5,j+6)\n\t\tdop<-profilm[lim]\n\t\tdsp<-profils[lim]\n\t\tprof<-(dop-dsp)^2\n\t\tpos<-seq(along=prof)[prof==min(prof)][1] # position des limite\n\t\tnlim<-lim[pos] # nouvelle limite\n\t\tvnlim<-c(vnlim,nlim) # on garde les valeurs des nouvelles limites\n\t\t}\n\tvnlim<-c(vnlim,length(profil))\n\tposition<-c(nlim[1]/2,nlim[-length(nlim)]+diff(nlim)/2)\n\ttext(position,max(profil),as.character(year),cex=0.8,col=2)\n\tplot(profil,pch=\".\",cex=2)\n\tlines(profilm,col=\"grey\")\n\tlines(profils,col=\"light green\")\n\ttitle(main=paste(\"New limits, profile\",nom,\"length\",round(l,1),\"mm\"))\n\t#abline(v=vnlim)\n\tpoints(vnlim,profil[vnlim],pc=1,col=2,cex=2)\n\tpoints(limites,profil[limites],pc=1,col=\"pink\",cex=1.5)\n  #readline()\n\tsortie <- list(length = 3)\n        sortie[[1]] <- profil # profil originel\n        sortie[[2]] <- unique(vnlim) # nouvelles limites\n\tsortie[[3]] <- year # millésimes originaux\n        names(sortie) <- c(\"profil\",\"limites\",\"millesimes\")\n        assign(paste(nom,sep=\"\"), sortie, pos = 1, immediate = T)\n\n\t}\n}\n",
    "created" : 1487058433706.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "3635090627",
    "id" : "45D5C644",
    "lastKnownWriteTime" : 1516618045,
    "last_content_update" : 1516618045497,
    "path" : "D:/thchauvin/Doc-INRA/Stats R/Packages/MicrodensiteR/R/ajustepositionlimite.R",
    "project_path" : "R/ajustepositionlimite.R",
    "properties" : {
    },
    "relative_order" : 6,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}