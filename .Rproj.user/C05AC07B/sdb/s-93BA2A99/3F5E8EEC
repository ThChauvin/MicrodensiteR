{
    "collab_server" : "",
    "contents" : "#' Cut_branche_begin\n#'\n#' @return\n#' @export\n#'\n#' @examples\ncut_branche_begin <- function(gg = \"dat\")\n{\n\n  liste<-objects(pattern= gg,pos=1)\n  noms <- substring(liste, 0)\n\n  for(i in 1:length(liste))\n  {\n    par(mfrow=c(2,1))\n    nom<-liste[i]\n    print(nom)\n    objet<-get(nom,pos=1)\n    profil<-objet$profil\n    limites<-objet$limites\n    millesimes<-objet$millesimes\n    plot(profil)\n    lines(profil,col=\"grey\")\n    abline(v=limites,col=\"green\")\n    points(limites,profil[limites],cex=1,col=\"red\",lwd=2)\n    text(limites-(limites-c(1,limites[-length(limites)]))/2,0.9*max(profil),as.character(millesimes),srt=90,cex=0.8,col=\"purple\")\n    title(main=paste(\"sample\",substring(liste[i],2,7)))\n    x=seq(along=profil)\n    p1=identify(x,profil,n=1) #valeur de la limite p1\n    p2=identify(x[limites],profil[limites],n=1) #position de la limite p2 dans limites\n    p2x=limites[p2] #valeur de la limite p2 (gauche de la moelle)\n    profilc=profil[p1:length(profil)] #profil sans le morceau à gauche du segment de cerne 2016\n    xc=x[p1:length(x)] #abcisse de profilc\n    profilg=profil[p1:p2x]\n    p3=limites[p2+1] #valeur de la limite p3 (droite de la moelle)\n    moelle=profil[p2x:p3]\n    profild=profil[p3:limites[length(limites)]]\n    plot(profilc,col=\"grey\")\n    #lines(profilc,col=\"grey\")\n    limites2=limites-p1+1\n    abline(v=limites2,col=\"grey\")\n    points(limites2,profilc[limites2],cex=1,col=\"grey\",lwd=2)\n    text(limites2-(limites2-c(1,limites2[-length(limites2)]))/2,0.9*max(profilc),as.character(millesimes),srt=90,cex=0.8,col=\"grey\")\n\n    #graphique de controle\n    p1c=1\n    p2c=p2x-p1+1\n    p3c=p3-p1+1\n    xg=p1c:p2c\n    xm=p2c:p3c\n    xd=p3c:length(profilc)\n\n    #print(paste(p1,p2x,p3))\n    #print(paste(p1c,p2c,p3c))\n    #print(paste(length(profilc),length(profilg),length(moelle),length(profild)))\n    #print(paste(length(xc),length(xg),length(xm),length(xd)))\n\n    lines(xg,profilg,col=\"red\")\n    lines(xm,moelle,col=\"green\")\n    lines(xd,profild,col=\"blue\")\n\n    readline()\n\n    #calcul et controle des limites et des millesimes des 2 segments gauche et droite\n    #le profilg doit être retourné pour avoir le coeur à gauche\n    pgr=rev(profilg)\n    #calcul des nouvelles limites du profil gauche retourné\n    lg=sort(length(pgr)-(limites[1:p2]-p1))\n    mg=sort(millesimes[1:p2]) #millesimes\n    #print(sort(lg))\n    #affichage pour contrôle\n    par(mfrow=c(1,2))\n    plot(pgr,col=\"grey\")\n    lines(pgr,col=\"red\")\n    abline(v=lg)\n    milieu=diff(c(lg,length(pgr)))/2 #position des millesimes sur le graphique\n    #print(c(lg,length(pgr)))\n    #print(milieu)\n    text(lg+milieu,0.9*max(pgr),as.character(mg),srt=90,cex=0.8,col=\"red\")\n    title(main=\"Rayon gauche retourné\")\n    #idem pour profil droit\n    plot(profild,col=\"grey\")\n    lines(profild,col=\"blue\")\n    #print(limites[(p2+1):length(limites)])\n    #print(limites[(p2+1):length(limites)]-(p1+length(pgr)+length(moelle)))\n    ld=limites[(p2+1):length(limites)]-p1-length(pgr)-length(moelle)+3\n    ld=ld[-length(ld)] #position des limites droites\n    print(ld)\n    abline(v=ld)\n    md=seq(from=min(mg),to=min(mg)+length(ld)-1,by=1)\n    print(md)\n    milieu=diff(c(ld,length(profild)))/2 #position des millesimes sur le graphique\n    print(ld+milieu)\n    text(ld+milieu,0.9*max(profild),as.character(md),srt=90,cex=0.8,col=\"red\")\n    title(main=\"Rayon droit\")\n\n    readline()\n    #sauvegarde\n    sortie <- list(length = 7)\n    sortie[[1]] <- profilg\n    sortie[[2]] <- profild\n    sortie[[3]] <- moelle\n    sortie[[4]] <- lg\n    sortie[[5]] <- ld\n    sortie[[6]] <- mg\n    sortie[[7]] <- md\n    names(sortie) <- c(\"profilg\",\"profild\",\"moelle\",\"limg\",\"limd\",\"milg\",\"mild\")\n    assign(paste(\"x\",nom,sep=\"\"), sortie, pos = 1, immediate = T) #nouveau nom : avec x devant\n  }\n}\n",
    "created" : 1496231216480.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "242098729",
    "id" : "3F5E8EEC",
    "lastKnownWriteTime" : 1496231350,
    "last_content_update" : 1496231350872,
    "path" : "D:/thchauvin/Doc-INRA/Stats R/Packages/MicrodensiteR/R/cut_branch_begin.R",
    "project_path" : "R/cut_branch_begin.R",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "relative_order" : 21,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}